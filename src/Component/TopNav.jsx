import React from 'react';
import {Route} from "react-router-dom";
import {withRouter} from "react-router";
import axios from "axios";
axios.defaults.headers['token'] = localStorage.getItem('token');

class TopNav extends React.Component {
    constructor(props) {
        super(props);
    }
    componentDidMount() {
    }
    topTitleClick = () => {
        this.props.history.push("/huche");

    }
    render() {
        return (
            <div className='TopNav'>
                <div className="TopNavTitle" onClick={this.topTitleClick}>
                    <svg id="title" width="250px" height="45px" viewBox="0 0 262 49" version="1.1">
                        <g id="名称">
                            <g id="Student" fill="#33548A">
                                <path
                                    d="M74.2041 35.2361L70.8545 35.2361L70.8545 32.0916L70.7861 32.0916Q68.7183 35.6804 64.3604 35.6804Q60.7715 35.6804 58.6523 33.1255Q56.5332 30.5706 56.5332 26.2297Q56.5332 21.5471 58.9258 18.7188Q61.3184 15.8904 65.1807 15.8904Q69.043 15.8904 70.7861 18.8982L70.8545 18.8982L70.8545 7.26001L74.2041 7.26001L74.2041 35.2361ZM2.1875 30.2629Q3.40088 31.3225 5.43457 32.0061Q7.46826 32.6897 9.29688 32.6897Q14.8682 32.6897 14.8682 28.7249Q14.8682 27.614 14.27 26.7253Q13.6719 25.8367 12.6294 25.1531Q11.5869 24.4695 8.71582 23.051Q4.73389 21.0686 3.46924 19.3682Q2.20459 17.6677 2.20459 15.4802Q2.20459 12.1819 4.85352 10.2507Q7.50244 8.31958 11.5356 8.31958Q15.4834 8.31958 17.3291 9.27661L17.3291 13.0022Q14.9365 11.3445 11.2793 11.3445Q8.85254 11.3445 7.323 12.3613Q5.79346 13.3782 5.79346 15.1897Q5.79346 16.7961 6.85303 17.8044Q7.9126 18.8127 11.4502 20.5559Q15.3467 22.4187 16.9019 24.2815Q18.457 26.1443 18.457 28.4685Q18.457 31.9548 15.9277 33.8176Q13.3984 35.6804 8.90381 35.6804Q7.33154 35.6804 5.23804 35.2446Q3.14453 34.8088 2.1875 34.1594L2.1875 30.2629ZM32.2656 35.0481Q31.1719 35.6462 29.3091 35.6462Q24.2334 35.6462 24.2334 30.0237L24.2334 19.1033L20.9863 19.1033L20.9863 16.3347L24.2334 16.3347L24.2334 11.7888L27.5659 10.7292L27.5659 16.3347L32.2656 16.3347L32.2656 19.1033L27.5659 19.1033L27.5659 29.4255Q27.5659 31.2883 28.1982 32.0916Q28.8306 32.8948 30.3003 32.8948Q31.4282 32.8948 32.2656 32.2625L32.2656 35.0481ZM127.729 35.6462Q129.592 35.6462 130.686 35.0481L130.686 32.2625Q129.849 32.8948 128.721 32.8948Q127.251 32.8948 126.619 32.0916Q125.986 31.2883 125.986 29.4255L125.986 19.1033L130.686 19.1033L130.686 16.3347L125.986 16.3347L125.986 10.7292L122.654 11.7888L122.654 16.3347L119.407 16.3347L119.407 19.1033L122.654 19.1033L122.654 30.0237Q122.654 35.6462 127.729 35.6462ZM82.356 26.6399L95.5835 26.6399L95.5835 24.948Q95.5835 20.6584 93.4985 18.2744Q91.4136 15.8904 87.7051 15.8904Q83.9624 15.8904 81.4417 18.7102Q78.9209 21.53 78.9209 25.8708Q78.9209 30.4851 81.2195 33.0828Q83.5181 35.6804 87.6196 35.6804Q91.7383 35.6804 94.2334 33.9202L94.2334 30.9294Q91.5845 32.9631 88.4058 32.9631Q85.5859 32.9631 84.0137 31.314Q82.4414 29.6648 82.356 26.6399ZM116.023 35.2361L112.69 35.2361L112.69 24.4866Q112.69 18.6589 108.435 18.6589Q106.23 18.6589 104.812 20.2996Q103.394 21.9402 103.394 24.4524L103.394 35.2361L100.044 35.2361L100.044 16.3347L103.394 16.3347L103.394 19.4622L103.462 19.4622Q105.598 15.8904 109.666 15.8904Q112.776 15.8904 114.399 17.8813Q116.023 19.8723 116.023 23.6833L116.023 35.2361ZM48.4668 35.2361L51.8335 35.2361L51.8335 16.3347L48.4668 16.3347L48.4668 27.2209Q48.4668 29.6819 47.1167 31.2969Q45.7666 32.9119 43.5791 32.9119Q39.1699 32.9119 39.1699 27.1526L39.1699 16.3347L35.8545 16.3347L35.8545 27.6482Q35.8545 35.6804 42.5708 35.6804Q46.5015 35.6804 48.3984 32.2625L48.4668 32.2625L48.4668 35.2361ZM91.0205 19.9919Q92.2168 21.3933 92.2339 23.9568L82.356 23.9568Q82.7319 21.5642 84.1931 20.0774Q85.6543 18.5906 87.6538 18.5906Q89.8242 18.5906 91.0205 19.9919ZM70.8716 23.991Q70.8716 21.718 69.3762 20.1885Q67.8809 18.6589 65.6934 18.6589Q63.0273 18.6589 61.4893 20.6499Q59.9512 22.6409 59.9512 26.0759Q59.9512 29.2375 61.4294 31.0747Q62.9077 32.9119 65.3687 32.9119Q67.7954 32.9119 69.3335 31.1089Q70.8716 29.3059 70.8716 26.6228L70.8716 23.991Z"/>
                            </g>
                            <g id="Club" fill="#E67F4F">
                                <path
                                    d="M158.047 7.26001L158.047 35.2361L161.396 35.2361L161.396 7.26001L158.047 7.26001ZM192.295 35.2361L192.295 32.5701L192.363 32.5701Q194.294 35.6804 197.986 35.6804Q201.899 35.6804 204.249 32.8521Q206.599 30.0237 206.599 25.2385Q206.599 20.8977 204.506 18.394Q202.412 15.8904 198.857 15.8904Q194.585 15.8904 192.363 19.5989L192.295 19.5989L192.295 7.26001L188.945 7.26001L188.945 35.2361L192.295 35.2361ZM145.862 35.6804Q150.271 35.6804 153.193 34.1423L153.193 30.8611Q150.288 32.6384 146.357 32.6384Q142.153 32.6384 139.556 29.8442Q136.958 27.05 136.958 22.2991Q136.958 17.2917 139.744 14.3438Q142.529 11.3958 146.956 11.3958Q150.356 11.3958 153.193 12.968L153.193 9.39624Q150.715 8.31958 146.921 8.31958Q141.025 8.31958 137.197 12.2161Q133.369 16.1126 133.369 22.5042Q133.369 28.4514 136.77 32.0659Q140.171 35.6804 145.862 35.6804ZM182.981 35.2361L179.614 35.2361L179.614 32.2625L179.546 32.2625Q177.649 35.6804 173.718 35.6804Q167.002 35.6804 167.002 27.6482L167.002 16.3347L170.317 16.3347L170.317 27.1526Q170.317 32.9119 174.727 32.9119Q176.914 32.9119 178.264 31.2969Q179.614 29.6819 179.614 27.2209L179.614 16.3347L182.981 16.3347L182.981 35.2361ZM193.765 31.3311Q192.278 29.7502 192.278 27.4602L192.278 24.8967Q192.278 22.1794 193.876 20.4192Q195.474 18.6589 197.935 18.6589Q200.361 18.6589 201.763 20.4277Q203.164 22.1965 203.164 25.1873Q203.164 28.8103 201.66 30.8611Q200.156 32.9119 197.49 32.9119Q195.251 32.9119 193.765 31.3311Z"/>
                            </g>
                        </g>
                    </svg>
                </div>
                {this.props.user && <Route component={TopNavRight}/>}
            </div>
        );
    }
}
class TopNavRight extends React.Component {
    constructor(props) {
        super(props);
        this.state = {
            login: false,
            name: '',
            img:'',
        }
    }

    componentDidMount() {
        axios.get("http://127.0.0.1:8000/signin/vertificationLog")
            .then(res => {
                if (res.data.login) {
                    this.setState({login: true,name: res.data.data.name, img: res.data.data.img})
                }
            })
            .catch(e => console.log(e));
    }

    handleLoginClock = () => {
        this.props.history.push('/login');

    };
    exitClick = () =>{
        localStorage.removeItem('token');
        this.props.history.push('/login');
    }

    render() {
        return (
            <ul className='TopNavLeft'>
                <div className='TopNavRightNameCon'>
                    <img className='TopNavImg' src={'http://127.0.0.1:8000/media/' + this.state.img} />
                    <a className="TopNavName">{this.state.login ? this.state.name : "游客"}</a>
                </div>
                <div className='TopNavUnt TopNavIcon TopNavUntDownCon '>
                    <svg width="25px" height="25px" viewBox="0 0 25 21">
                        <path
                            d="M2 0L23 0Q23.1025 0 23.2034 0.00932124Q23.3044 0.0186425 23.4029 0.037209Q23.5014 0.0557754 23.5967 0.0834357Q23.692 0.111096 23.7833 0.147624Q23.8747 0.184153 23.9612 0.229252Q24.0478 0.27435 24.129 0.327651Q24.2101 0.380953 24.2852 0.442021Q24.3602 0.50309 24.4286 0.571429Q24.4969 0.639767 24.558 0.714818Q24.619 0.789868 24.6723 0.871019Q24.7257 0.95217 24.7708 1.03876Q24.8159 1.12535 24.8524 1.21667Q24.8889 1.30799 24.9166 1.4033Q24.9442 1.49861 24.9628 1.59713Q24.9814 1.69564 24.9907 1.79657Q25 1.89749 25 2L25 3Q25 3.10251 24.9907 3.20343Q24.9814 3.30436 24.9628 3.40287Q24.9442 3.50139 24.9166 3.5967Q24.8889 3.69201 24.8524 3.78333Q24.8159 3.87465 24.7708 3.96124Q24.7257 4.04783 24.6723 4.12898Q24.619 4.21013 24.558 4.28518Q24.4969 4.36023 24.4286 4.42857Q24.3602 4.49691 24.2852 4.55798Q24.2101 4.61905 24.129 4.67235Q24.0478 4.72565 23.9612 4.77075Q23.8747 4.81585 23.7833 4.85238Q23.692 4.8889 23.5967 4.91656Q23.5014 4.94422 23.4029 4.96279Q23.3044 4.98136 23.2034 4.99068Q23.1025 5 23 5L15.8194 5L2 5Q1.89749 5 1.79657 4.99068Q1.69564 4.98136 1.59713 4.96279Q1.49861 4.94422 1.4033 4.91656Q1.30799 4.8889 1.21667 4.85238Q1.12535 4.81585 1.03876 4.77075Q0.95217 4.72565 0.871019 4.67235Q0.789868 4.61905 0.714818 4.55798Q0.639767 4.49691 0.571429 4.42857Q0.50309 4.36023 0.442021 4.28518Q0.380953 4.21013 0.327651 4.12898Q0.27435 4.04783 0.229252 3.96124Q0.184153 3.87465 0.147624 3.78333Q0.111096 3.69201 0.0834357 3.5967Q0.0557754 3.50139 0.037209 3.40287Q0.0186425 3.30436 0.00932124 3.20343Q0 3.10251 0 3L0 2Q0 1.89749 0.00932124 1.79657Q0.0186425 1.69564 0.037209 1.59713Q0.0557754 1.49861 0.0834357 1.4033Q0.111096 1.30799 0.147624 1.21667Q0.184153 1.12535 0.229252 1.03876Q0.27435 0.95217 0.327651 0.871019Q0.380953 0.789868 0.442021 0.714818Q0.50309 0.639767 0.571429 0.571429Q0.639767 0.50309 0.714818 0.442021Q0.789868 0.380953 0.871019 0.327651Q0.95217 0.27435 1.03876 0.229252Q1.12535 0.184153 1.21667 0.147624Q1.30799 0.111096 1.4033 0.0834357Q1.49861 0.0557754 1.59713 0.037209Q1.69564 0.0186425 1.79657 0.00932124Q1.89749 0 2 0Z"
                            transform="translate(0 16)" id="3" fill="#33548A" stroke="none"/>
                        <path
                            d="M2 0L23 0Q23.1025 0 23.2034 0.00932124Q23.3044 0.0186425 23.4029 0.037209Q23.5014 0.0557754 23.5967 0.0834357Q23.692 0.111096 23.7833 0.147624Q23.8747 0.184153 23.9612 0.229252Q24.0478 0.27435 24.129 0.327651Q24.2101 0.380953 24.2852 0.442021Q24.3602 0.50309 24.4286 0.571429Q24.4969 0.639767 24.558 0.714818Q24.619 0.789868 24.6723 0.871019Q24.7257 0.95217 24.7708 1.03876Q24.8159 1.12535 24.8524 1.21667Q24.8889 1.30799 24.9166 1.4033Q24.9442 1.49861 24.9628 1.59713Q24.9814 1.69564 24.9907 1.79657Q25 1.89749 25 2L25 3Q25 3.10251 24.9907 3.20343Q24.9814 3.30436 24.9628 3.40287Q24.9442 3.50139 24.9166 3.5967Q24.8889 3.69201 24.8524 3.78333Q24.8159 3.87465 24.7708 3.96124Q24.7257 4.04783 24.6723 4.12898Q24.619 4.21013 24.558 4.28518Q24.4969 4.36023 24.4286 4.42857Q24.3602 4.49691 24.2852 4.55798Q24.2101 4.61905 24.129 4.67235Q24.0478 4.72565 23.9612 4.77075Q23.8747 4.81585 23.7833 4.85238Q23.692 4.8889 23.5967 4.91656Q23.5014 4.94422 23.4029 4.96279Q23.3044 4.98136 23.2034 4.99068Q23.1025 5 23 5L2 5Q1.89749 5 1.79657 4.99068Q1.69564 4.98136 1.59713 4.96279Q1.49861 4.94422 1.4033 4.91656Q1.30799 4.8889 1.21667 4.85238Q1.12535 4.81585 1.03876 4.77075Q0.95217 4.72565 0.871019 4.67235Q0.789868 4.61905 0.714818 4.55798Q0.639767 4.49691 0.571429 4.42857Q0.50309 4.36023 0.442021 4.28518Q0.380953 4.21013 0.327651 4.12898Q0.27435 4.04783 0.229252 3.96124Q0.184153 3.87465 0.147624 3.78333Q0.111096 3.69201 0.0834357 3.5967Q0.0557754 3.50139 0.037209 3.40287Q0.0186425 3.30436 0.00932124 3.20343Q0 3.10251 0 3L0 2Q0 1.89749 0.00932124 1.79657Q0.0186425 1.69564 0.037209 1.59713Q0.0557754 1.49861 0.0834357 1.4033Q0.111096 1.30799 0.147624 1.21667Q0.184153 1.12535 0.229252 1.03876Q0.27435 0.95217 0.327651 0.871019Q0.380953 0.789868 0.442021 0.714818Q0.50309 0.639767 0.571429 0.571429Q0.639767 0.50309 0.714818 0.442021Q0.789868 0.380953 0.871019 0.327651Q0.95217 0.27435 1.03876 0.229252Q1.12535 0.184153 1.21667 0.147624Q1.30799 0.111096 1.4033 0.0834357Q1.49861 0.0557754 1.59713 0.037209Q1.69564 0.0186425 1.79657 0.00932124Q1.89749 0 2 0Z"
                            transform="translate(0 8)" id="2" fill="#E67F4F" stroke="none"/>
                        <path
                            d="M2 0L23 0Q23.1025 0 23.2034 0.00932124Q23.3044 0.0186425 23.4029 0.037209Q23.5014 0.0557754 23.5967 0.0834357Q23.692 0.111096 23.7833 0.147624Q23.8747 0.184153 23.9612 0.229252Q24.0478 0.27435 24.129 0.327651Q24.2101 0.380953 24.2852 0.442021Q24.3602 0.50309 24.4286 0.571429Q24.4969 0.639767 24.558 0.714818Q24.619 0.789868 24.6723 0.871019Q24.7257 0.95217 24.7708 1.03876Q24.8159 1.12535 24.8524 1.21667Q24.8889 1.30799 24.9166 1.4033Q24.9442 1.49861 24.9628 1.59713Q24.9814 1.69564 24.9907 1.79657Q25 1.89749 25 2L25 3Q25 3.10251 24.9907 3.20343Q24.9814 3.30436 24.9628 3.40287Q24.9442 3.50139 24.9166 3.5967Q24.8889 3.69201 24.8524 3.78333Q24.8159 3.87465 24.7708 3.96124Q24.7257 4.04783 24.6723 4.12898Q24.619 4.21013 24.558 4.28518Q24.4969 4.36023 24.4286 4.42857Q24.3602 4.49691 24.2852 4.55798Q24.2101 4.61905 24.129 4.67235Q24.0478 4.72565 23.9612 4.77075Q23.8747 4.81585 23.7833 4.85238Q23.692 4.8889 23.5967 4.91656Q23.5014 4.94422 23.4029 4.96279Q23.3044 4.98136 23.2034 4.99068Q23.1025 5 23 5L2 5Q1.89749 5 1.79657 4.99068Q1.69564 4.98136 1.59713 4.96279Q1.49861 4.94422 1.4033 4.91656Q1.30799 4.8889 1.21667 4.85238Q1.12535 4.81585 1.03876 4.77075Q0.95217 4.72565 0.871019 4.67235Q0.789868 4.61905 0.714818 4.55798Q0.639767 4.49691 0.571429 4.42857Q0.50309 4.36023 0.442021 4.28518Q0.380953 4.21013 0.327651 4.12898Q0.27435 4.04783 0.229252 3.96124Q0.184153 3.87465 0.147624 3.78333Q0.111096 3.69201 0.0834357 3.5967Q0.0557754 3.50139 0.037209 3.40287Q0.0186425 3.30436 0.00932124 3.20343Q0 3.10251 0 3L0 2Q0 1.89749 0.00932124 1.79657Q0.0186425 1.69564 0.037209 1.59713Q0.0557754 1.49861 0.0834357 1.4033Q0.111096 1.30799 0.147624 1.21667Q0.184153 1.12535 0.229252 1.03876Q0.27435 0.95217 0.327651 0.871019Q0.380953 0.789868 0.442021 0.714818Q0.50309 0.639767 0.571429 0.571429Q0.639767 0.50309 0.714818 0.442021Q0.789868 0.380953 0.871019 0.327651Q0.95217 0.27435 1.03876 0.229252Q1.12535 0.184153 1.21667 0.147624Q1.30799 0.111096 1.4033 0.0834357Q1.49861 0.0557754 1.59713 0.037209Q1.69564 0.0186425 1.79657 0.00932124Q1.89749 0 2 0Z"
                            id="1" fill="#33548A" stroke="none"/>
                    </svg>
                    <div className='TopNavUntDown'>
                        {
                            this.state.login ?
                            <ul className='TopNavUntDownTitle'>
                                <li>设置</li>
                                <li onClick={this.exitClick}>退出</li>
                            </ul>
                            : 
                            <ul className='TopNavUntDownTitle'>
                            <li  onClick={this.handleLoginClock}>登陆</li>
                            </ul>
                        }
                    </div>
                </div>
                <div className='TopNavSug TopNavIcon'>
                    <svg width="28px" height="28px">
                        <g>
                            <path
                                d="M25.6291 21.7976C25.2698 22.3324 24.5449 22.4748 24.0101 22.1155C23.4752 21.7562 23.3329 21.0313 23.6922 20.4965C24.9727 18.5901 25.6667 16.3483 25.6667 14C25.6667 7.55668 20.4433 2.33333 14 2.33333C7.55668 2.33333 2.33333 7.55668 2.33333 14C2.33333 20.4433 7.55668 25.6667 14 25.6667C16.3595 25.6667 18.6116 24.966 20.5235 23.6739C21.0574 23.3132 21.7826 23.4535 22.1434 23.9873C22.5042 24.5212 22.3639 25.2464 21.83 25.6072C19.5352 27.158 16.8289 28 14 28C6.26801 28 0 21.732 0 14C0 6.26801 6.26801 0 14 0C21.732 0 28 6.26801 28 14C28 16.8154 27.1661 19.5094 25.6291 21.7976Z"
                                id="Combined-Shape" fill="#E67F4F" stroke="none"/>
                            <path
                                d="M4.66667 17.5C3.378 17.5 2.33333 16.4553 2.33333 15.1667C2.33333 13.878 3.378 12.8333 4.66667 12.8333C5.95533 12.8333 7 13.878 7 15.1667C7 16.4553 5.95533 17.5 4.66667 17.5ZM5.83333 10.5C5.83331 11.1444 5.31096 11.6667 4.66663 11.6667C4.0223 11.6666 3.49998 11.1443 3.5 10.5L3.5 10.415C3.5 8.77271 4.36323 7.25133 5.773 6.40897C6.63841 5.89187 7 5.33923 7 4.66667C7 3.378 5.95533 2.33333 4.66667 2.33333C3.378 2.33333 2.33333 3.378 2.33333 4.66667C2.33333 5.311 1.811 5.83333 1.16667 5.83333C0.522334 5.83333 0 5.311 0 4.66667C0 2.08934 2.08934 0 4.66667 0C7.244 0 9.33333 2.08934 9.33333 4.66667C9.33333 6.22225 8.49809 7.49882 6.96983 8.41197C6.26495 8.83316 5.83334 9.59385 5.83334 10.415L5.83333 10.5Z"
                                transform="translate(9.333252 5.833336)" id="Combined-Shape" fill="#33548A"
                                stroke="none"/>
                        </g>
                    </svg>
                </div>
            </ul>
        );
    }
}
export default withRouter(TopNav)
